<div class="login-container">
    <style>
        .error small {
            color: red;
            font-size: 0.85rem;
            display: block;
            margin-top: 4px;
        }
    </style>
    <!-- Left: Infinite Food Gallery -->
    <div class="visual-side">
        <div class="infinite-scroll-wrapper">
            <!-- Column 1: Slow Up -->
            <div class="scroll-col col-1">
                <div class="food-item"
                    style="background-image: url('https://images.unsplash.com/photo-1565299624946-b28f40a0ae38?q=80&w=800')">
                </div>
                <div class="food-item"
                    style="background-image: url('https://images.unsplash.com/photo-1565958011703-44f9829ba187?q=80&w=800')">
                </div>
                <div class="food-item"
                    style="background-image: url('https://images.unsplash.com/photo-1482049016688-2d3e1b311543?q=80&w=800')">
                </div>
                <div class="food-item"
                    style="background-image: url('https://images.unsplash.com/photo-1565299624946-b28f40a0ae38?q=80&w=800')">
                </div>
            </div>
            <!-- Column 2: Slow Down -->
            <div class="scroll-col col-2">
                <div class="food-item"
                    style="background-image: url('https://images.unsplash.com/photo-1540189549336-e6e99c3679fe?q=80&w=800')">
                </div>
                <div class="food-item"
                    style="background-image: url('https://images.unsplash.com/photo-1567620905732-2d1ec7ab7445?q=80&w=800')">
                </div>
                <div class="food-item"
                    style="background-image: url('https://images.unsplash.com/photo-1546069901-ba9599a7e63c?q=80&w=800')">
                </div>
                <div class="food-item"
                    style="background-image: url('https://images.unsplash.com/photo-1540189549336-e6e99c3679fe?q=80&w=800')">
                </div>
            </div>
        </div>

        <div class="visual-overlay">
            <div class="glass-badge">
                <span class="live-dot"></span>
                <span>Live Orders: <strong>14.2k+</strong></span>
            </div>
            <div class="hero-text">
                <h1>Fresh Start, <br><em>New Password.</em></h1>
            </div>
        </div>
    </div>

    <!-- Right: Auth Interaction -->
    <div class="auth-side">
        <div class="auth-card">

            <div class="logo-row">
                <div class="logo-mark">üç≤</div>
                <span>speak2eat</span>
            </div>

            <!-- Loading State -->
            <div *ngIf="isCheckingSession" class="status-message">
                <h2>Verifying Link...</h2>
                <div class="spinner"></div>
            </div>

            <!-- Invalid Session State -->
            <div *ngIf="!isCheckingSession && !isSessionValid" class="status-message error-state">
                <h2>Link Expired</h2>
                <p>This password reset link is invalid or has expired.</p>

                <a routerLink="/forgot-password" class="hero-btn"
                    style="text-decoration: none; text-align: center; display: flex; justify-content: center; align-items: center;">
                    <span>Request New Link</span>
                </a>
            </div>

            <!-- Valid Form State -->
            <div *ngIf="!isCheckingSession && isSessionValid">
                <div class="header-text">
                    <h2>Reset Password</h2>
                    <p>Create a new strong password for your account.</p>
                </div>

                <!-- Animated Inputs -->
                <form class="login-form" [formGroup]="resetForm" (ngSubmit)="onSubmit()">

                    <!-- New Password Field -->
                    <div class="anim-input-group">
                        <input type="password" formControlName="newPassword" required id="newPassword">
                        <label for="newPassword">New Password</label>
                        <div class="highlight-bar"></div>
                        <div class="icon-slot">üîí</div>

                        <!-- Validation Errors -->
                        <div class="error"
                            *ngIf="resetForm.get('newPassword')?.touched && resetForm.get('newPassword')?.invalid">
                            <small *ngIf="resetForm.get('newPassword')?.errors?.['required']">Password is
                                required.</small>
                            <small *ngIf="resetForm.get('newPassword')?.errors?.['minlength']">Must be at least 6
                                characters.</small>
                        </div>
                    </div>

                    <!-- Confirm Password Field -->
                    <div class="anim-input-group">
                        <input type="password" formControlName="confirmPassword" required id="confirmPassword">
                        <label for="confirmPassword">Confirm Password</label>
                        <div class="highlight-bar"></div>
                        <div class="icon-slot">üîí</div>

                        <!-- Validation Errors -->
                        <div class="error"
                            *ngIf="resetForm.get('confirmPassword')?.touched && resetForm.get('confirmPassword')?.invalid">
                            <small *ngIf="resetForm.get('confirmPassword')?.errors?.['required']">Confirmation is
                                required.</small>
                        </div>
                        <div class="error"
                            *ngIf="resetForm.errors?.['mismatch'] && (resetForm.get('confirmPassword')?.touched || resetForm.get('newPassword')?.touched)">
                            <small>Passwords do not match.</small>
                        </div>
                    </div>

                    <button type="submit" class="hero-btn" [disabled]="isSubmitting || resetForm.invalid">
                        <span *ngIf="!isSubmitting">Set New Password</span>
                        <span *ngIf="isSubmitting">Updating...</span>
                        <div class="liquid-bg"></div>
                    </button>
                </form>
            </div>

        </div>
    </div>

</div>